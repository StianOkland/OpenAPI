{"version":3,"file":"react-responsive-select.cjs.development.js","sources":["../src/constants/actionTypes.ts","../src/lib/eventHandlers/handleAlphaNumerical.ts","../src/lib/isEqual.ts","../src/lib/onChangeBroadcasters/multiSelectBroadcastChange.ts","../src/lib/onChangeBroadcasters/singleSelectBroadcastChange.ts","../src/lib/eventHandlers/handleBlur.ts","../src/lib/containsClassName.ts","../src/lib/eventHandlers/handleClick.ts","../src/lib/eventHandlers/handleEnterPressed.ts","../src/constants/keyCodes.ts","../src/lib/preventDefaultForKeyCodes.ts","../src/lib/nextValidIndex.ts","../src/lib/getNextIndex.ts","../src/lib/eventHandlers/handleKeyUpOrDownPressed.ts","../src/lib/eventHandlers/handleKeyEvent.ts","../src/lib/eventHandlers/handleTouchMove.ts","../src/lib/eventHandlers/handleTouchStart.ts","../src/lib/getCustomLabelText.ts","../src/reducers/initialState.ts","../src/reducers/lib/addMultiSelectIndex.ts","../src/reducers/lib/addMultiSelectOption.ts","../src/reducers/lib/getInitialMultiSelectOption.ts","../src/reducers/lib/getMultiSelectInitialSelectedOptions.ts","../src/reducers/lib/getMultiSelectSelectedValueIndexes.ts","../src/reducers/lib/getSelectedValueIndex.ts","../src/reducers/lib/getSingleSelectSelectedOption.ts","../src/reducers/lib/mergeIsAlteredState.ts","../src/reducers/lib/removeMultiSelectIndex.ts","../src/reducers/lib/removeMultiSelectOption.ts","../src/reducers/lib/resetMultiSelectState.ts","../src/reducers/reducer.ts","../src/components/MultiSelectOption.tsx","../src/components/MultiSelect.tsx","../src/components/SingleSelectOption.tsx","../src/components/SingleSelect.tsx","../src/Extras.tsx","../src/react-responsive-select.tsx"],"sourcesContent":["export const INITIALISE = 'INITIALISE';\nexport const SET_IS_DRAGGING = 'SET_IS_DRAGGING';\nexport const SET_OPTIONS_PANEL_OPEN = 'SET_OPTIONS_PANEL_OPEN';\nexport const SET_OPTIONS_PANEL_CLOSED = 'SET_OPTIONS_PANEL_CLOSED';\nexport const SET_SINGLESELECT_OPTIONS = 'SET_SINGLESELECT_OPTIONS';\nexport const SET_MULTISELECT_OPTIONS = 'SET_MULTISELECT_OPTIONS';\nexport const SET_OPTIONS_PANEL_CLOSED_NO_SELECTION = 'SET_OPTIONS_PANEL_CLOSED_NO_SELECTION';\nexport const SET_OPTIONS_PANEL_CLOSED_ONBLUR = 'SET_OPTIONS_PANEL_CLOSED_ONBLUR';\nexport const SET_NEXT_SELECTED_INDEX = 'SET_NEXT_SELECTED_INDEX';\nexport const SET_NEXT_SELECTED_INDEX_ALPHA_NUMERIC = 'SET_NEXT_SELECTED_INDEX_ALPHA_NUMERIC';\n","import * as actionTypes from '../../constants/actionTypes';\nimport { Select } from '../../react-responsive-select';\nimport { IOption, IState } from '../../types/';\n\ninterface IArgs {\n  event: KeyboardEvent;\n  state: IState;\n  RRSClassRef: Select;\n}\n\nlet stringMatch: string = '';\nlet timeoutActive: boolean;\n\n/**\n * User types some keys in quick successsion whilst focused on a select - search for this combonation in their options\n */\nexport function handleAlphaNumerical({ event, state, RRSClassRef }: IArgs): void {\n  const { options, disabled } = state;\n\n  if (disabled) return;\n\n  // Accumulate users key presses\n  stringMatch = stringMatch + event.key;\n\n  if (!timeoutActive) {\n    timeoutActive = true;\n\n    // Eventually (after 250ms) check if the accumulation of their keypresses matches the text of an option\n    setTimeout(() => {\n      const foundIndexes: number[] = options.reduce((acc: number[], option: IOption, index: number) => {\n        if (\n          !option.optHeader &&\n          !option.disabled &&\n          option.text &&\n          option.text.toLowerCase().indexOf(stringMatch) !== -1\n        ) {\n          acc.push(index);\n        }\n        return acc;\n      }, []);\n\n      if (foundIndexes.length > 0) {\n        RRSClassRef.updateState({\n          value: foundIndexes[0],\n          type: actionTypes.SET_NEXT_SELECTED_INDEX_ALPHA_NUMERIC,\n        });\n      }\n\n      // allow for the creation of a new search\n      timeoutActive = false;\n      stringMatch = '';\n    }, 250);\n  }\n}\n","const skipCircularReference = () => {\n  let cache: any[] = [];\n  return (_key: string, value: any) => {\n    if (typeof value === 'object' && value !== null) {\n      // Circular reference found\n      if (cache.indexOf(value) !== -1) return;\n      cache.push(value);\n    }\n    // No circular reference found\n    return value;\n  };\n};\n\nexport function isEqual(a: any, b: any): boolean {\n  return JSON.stringify(a, skipCircularReference()) === JSON.stringify(b, skipCircularReference());\n}\n","import { IOutputMultiSelect, IOutputMultiSelectOption } from '../../types/';\nimport { isEqual } from '../../lib/isEqual';\n\nexport function multiSelectBroadcastChange(\n  currOptions: IOutputMultiSelectOption[],\n  altered: boolean,\n  fn?: (changes: IOutputMultiSelect) => void,\n  prevOptions?: IOutputMultiSelectOption[]\n): void {\n  if (!fn) return;\n\n  const shouldBroadcastChange = !prevOptions || !isEqual(prevOptions.values, currOptions.values);\n\n  if (shouldBroadcastChange) {\n    fn({\n      options: currOptions.map((currOption: IOutputMultiSelectOption) => ({\n        name: currOption.name || '',\n        text: currOption.text || '',\n        value: currOption.value || '',\n      })),\n      altered,\n    });\n  }\n}\n","import { IOutputSingleSelect } from '../../types/';\nimport { isEqual } from '../../lib/isEqual';\n\nexport function singleSelectBroadcastChange(\n  currValue: IOutputSingleSelect,\n  altered?: boolean,\n  fn?: (changes: IOutputSingleSelect) => void,\n  prevValue?: IOutputSingleSelect\n): void {\n  if (!fn) return;\n\n  const shouldBroadcastChange = !isEqual(prevValue?.value, currValue?.value);\n\n  if (shouldBroadcastChange) {\n    fn({\n      name: currValue.name,\n      text: currValue.text,\n      value: currValue.value,\n      altered,\n    });\n  }\n}\n","import * as actionTypes from '../../constants/actionTypes';\nimport { Select } from '../../react-responsive-select';\nimport { IProps, IState } from '../../types/';\nimport { multiSelectBroadcastChange, singleSelectBroadcastChange } from '../onChangeBroadcasters';\n\ninterface TArgs {\n  state: IState;\n  RRSClassRef: Select;\n  props: IProps;\n}\n\nexport function handleBlur({ state, RRSClassRef, props }: TArgs): void {\n  const { onBlur, multiselect } = props;\n  const { isOptionsPanelOpen, disabled, altered, singleSelectSelectedOption, multiSelectSelectedOptions } = state;\n\n  if (disabled) return;\n\n  const isOutsideSelectBox = RRSClassRef.selectBox && !RRSClassRef.selectBox.contains(document.activeElement);\n\n  /* Handle click outside of selectbox */\n  if (isOptionsPanelOpen && isOutsideSelectBox) {\n    RRSClassRef.updateState({\n      type: actionTypes.SET_OPTIONS_PANEL_CLOSED_ONBLUR,\n    });\n  }\n\n  if (isOutsideSelectBox && onBlur) {\n    if (multiselect) {\n      multiSelectBroadcastChange(multiSelectSelectedOptions.options, Boolean(altered), onBlur);\n    } else {\n      singleSelectBroadcastChange(singleSelectSelectedOption, Boolean(altered), onBlur);\n    }\n  }\n}\n","export function containsClassName(element: HTMLElement, classNameStr: string): boolean {\n  return (\n    String(element.className)\n      .split(' ')\n      .indexOf(classNameStr) > -1\n  );\n}\n","import * as actionTypes from '../../constants/actionTypes';\nimport { Select } from '../../react-responsive-select';\nimport { containsClassName } from '../containsClassName';\n\nimport { IState, IProps } from '../../types/';\n\ninterface TArgs {\n  event: MouseEvent | KeyboardEvent;\n  state: IState;\n  RRSClassRef: Select;\n  props: IProps;\n}\n\nexport function handleClick({ event, state, RRSClassRef, props }: TArgs): void {\n  const { multiselect, multiSelectSelectedOptions, isOptionsPanelOpen, isDragging, disabled, options } = state;\n\n  if (disabled) return;\n\n  if (isDragging === false) {\n    /* Disallow natural event flow - don't allow blur to happen from button focus to selected option focus */\n    event.preventDefault();\n\n    if (event && containsClassName(event.target as HTMLElement, 'rrs__options')) {\n      return;\n    }\n\n    const value = parseFloat((event.target as any).getAttribute('data-key'));\n\n    if (options[value] && (options[value].disabled === true || options[value].optHeader === true)) {\n      return;\n    }\n\n    /* Select option index, if user selected option */\n    if (containsClassName(event.target as HTMLElement, 'rrs__option')) {\n      if (multiselect) {\n        const isExistingSelection = multiSelectSelectedOptions.options.some(\n          option => options[value] && options[value].hasOwnProperty('value') && option.value === options[value].value\n        );\n\n        if (!isExistingSelection && props.onSelect) {\n          props.onSelect(options[value]);\n        } else if (isExistingSelection && props.onDeselect) {\n          props.onDeselect(options[value]);\n        }\n      } else if (!multiselect && props.onSelect) {\n        props.onSelect(options[value]);\n      }\n\n      RRSClassRef.updateState({\n        type: multiselect ? actionTypes.SET_MULTISELECT_OPTIONS : actionTypes.SET_SINGLESELECT_OPTIONS,\n        value,\n      });\n\n      return;\n    }\n\n    /*\n      When the options panel is open, treat clicking the label/select button\n      or the background overlay on small screen as a 'no action'\n    */\n    if (\n      isOptionsPanelOpen &&\n      // button on desktop (rrs__label) or overlay on small screen (rrs)\n      (containsClassName(event.target as HTMLElement, 'rrs__label') ||\n        containsClassName(event.target as HTMLElement, 'rrs'))\n    ) {\n      RRSClassRef.updateState(\n        {\n          type: actionTypes.SET_OPTIONS_PANEL_CLOSED_NO_SELECTION,\n        },\n        () => RRSClassRef.focusButton()\n      );\n\n      return;\n    }\n\n    /* Else user clicked close or open the options panel */\n    RRSClassRef.updateState(\n      {\n        type: isOptionsPanelOpen ? actionTypes.SET_OPTIONS_PANEL_CLOSED : actionTypes.SET_OPTIONS_PANEL_OPEN,\n      },\n      (newState: IState) => {\n        // After state update, check if focus should be moved to the button\n        if (newState.isOptionsPanelOpen === false) {\n          RRSClassRef.focusButton();\n        }\n      }\n    );\n  }\n}\n","import * as actionTypes from '../../constants/actionTypes';\nimport { Select } from '../../react-responsive-select';\nimport { IProps, IState } from '../../types/';\n\ninterface IArgs {\n  event: KeyboardEvent;\n  state: IState;\n  props: IProps;\n  RRSClassRef: Select;\n}\n\nexport function handleEnterPressed({ event, state, props, RRSClassRef }: IArgs): void {\n  const { disabled, isOptionsPanelOpen, multiselect, nextPotentialSelectionIndex, options } = state;\n\n  if (disabled) return;\n\n  const value = parseFloat((event.target as any).getAttribute('data-key'));\n\n  if (options[value] && (options[value].disabled === true || options[value].optHeader === true)) {\n    return;\n  }\n\n  if (multiselect) {\n    const isExistingSelection = state.multiSelectSelectedOptions.options.some(\n      option => options[value] && options[value].hasOwnProperty('value') && option.value === options[value].value\n    );\n\n    if (!isExistingSelection && props.onSelect) {\n      props.onSelect(options[value]);\n    } else if (isExistingSelection && props.onDeselect) {\n      props.onDeselect(options[value]);\n    }\n\n    RRSClassRef.updateState({\n      type: actionTypes.SET_MULTISELECT_OPTIONS,\n      value: nextPotentialSelectionIndex,\n    });\n  } else {\n    if (props.onSelect) {\n      props.onSelect(options[value]);\n    }\n\n    RRSClassRef.updateState({\n      type: actionTypes.SET_SINGLESELECT_OPTIONS,\n      value: nextPotentialSelectionIndex,\n    });\n  }\n\n  if (isOptionsPanelOpen) {\n    event.stopPropagation(); // Do not submit form\n  } else {\n    // tslint:disable-next-line\n    props.onSubmit && props.onSubmit(event); // Submit the form\n  }\n}\n","export const keyCodes = {\n  TAB: 9,\n  ENTER: 13,\n  SPACE: 32,\n  ESCAPE: 27,\n  UP: 38,\n  DOWN: 40,\n};\n","export function preventDefaultForKeyCodes(keyCodes: number[], e: KeyboardEvent): void {\n  keyCodes.forEach((keyCode: number) => {\n    if (keyCode === e.keyCode) {\n      e.preventDefault();\n    }\n  });\n}\n","import { IOption, IState } from '../types/';\n\nexport function nextValidIndex(\n  state: IState,\n  nextPotentialSelectionIndex: number,\n  mode: 'INCREMENT' | 'DECREMENT' = 'INCREMENT'\n): number {\n  const { options } = state;\n\n  const possibleOptionIndexes = options.reduce((acc: number[], option: IOption, index: number) => {\n    if (!option.optHeader) acc.push(index);\n    return acc;\n  }, []);\n\n  const indexNotFocusable = possibleOptionIndexes.indexOf(nextPotentialSelectionIndex) === -1;\n\n  if (indexNotFocusable && mode === 'INCREMENT') {\n    const nextSelectionPossible =\n      options[nextPotentialSelectionIndex + 1] && !options[nextPotentialSelectionIndex + 1].optHeader;\n\n    return nextSelectionPossible ? nextPotentialSelectionIndex + 1 : possibleOptionIndexes[0];\n  }\n\n  if (indexNotFocusable && mode === 'DECREMENT') {\n    const nextSelectionPossible =\n      options[nextPotentialSelectionIndex - 1] && !options[nextPotentialSelectionIndex - 1].optHeader;\n\n    return nextSelectionPossible\n      ? nextPotentialSelectionIndex - 1\n      : possibleOptionIndexes[possibleOptionIndexes.length - 1];\n  }\n\n  return nextPotentialSelectionIndex;\n}\n","import { IState } from '../types/';\nimport { nextValidIndex } from './nextValidIndex';\n\nexport function getNextIndex(mode: 'INCREMENT' | 'DECREMENT', state: IState): number {\n  const { isOptionsPanelOpen, nextPotentialSelectionIndex, options } = state;\n\n  switch (mode) {\n    case 'INCREMENT':\n      // Hold selection on current selected option when options panel first opens\n      if (isOptionsPanelOpen === false) {\n        return nextValidIndex(state, nextPotentialSelectionIndex, 'INCREMENT');\n      }\n\n      // User is at the end of the options so cycle back to start\n      if (nextPotentialSelectionIndex === options.length - 1) {\n        return nextValidIndex(state, 0, 'INCREMENT');\n      }\n\n      // Else increment\n      return nextValidIndex(state, nextPotentialSelectionIndex + 1, 'INCREMENT');\n\n    case 'DECREMENT':\n      // Hold selection on current selected option when options panel first opens\n      if (isOptionsPanelOpen === false) {\n        return nextValidIndex(state, nextPotentialSelectionIndex, 'DECREMENT');\n      }\n\n      // User is at start of the options so cycle around to end\n      if (nextPotentialSelectionIndex === 0) {\n        return nextValidIndex(state, options.length - 1, 'DECREMENT');\n      }\n\n      // Else decrement\n      return nextValidIndex(state, nextPotentialSelectionIndex - 1, 'DECREMENT');\n\n    default:\n      return nextValidIndex(state, 0, 'DECREMENT');\n  }\n}\n","import * as actionTypes from '../../constants/actionTypes';\nimport { Select } from '../../react-responsive-select';\nimport { IState } from '../../types/';\nimport { getNextIndex } from '../getNextIndex';\n\ninterface TArgs {\n  state: IState;\n  type: 'INCREMENT' | 'DECREMENT';\n  RRSClassRef: Select;\n}\n\nexport function handleKeyUpOrDownPressed({ state, RRSClassRef, type }: TArgs): void {\n  const { isOptionsPanelOpen, disabled } = state;\n\n  if (disabled) return;\n\n  RRSClassRef.updateState({\n    type: actionTypes.SET_NEXT_SELECTED_INDEX,\n    value: getNextIndex(type, state),\n  });\n\n  /* Open the options panel */\n  if (isOptionsPanelOpen === false) {\n    RRSClassRef.updateState({\n      type: actionTypes.SET_OPTIONS_PANEL_OPEN,\n    });\n  }\n}\n","import * as actionTypes from '../../constants/actionTypes';\nimport { keyCodes } from '../../constants/keyCodes';\nimport { Select } from '../../react-responsive-select';\nimport { IProps, IState } from '../../types/';\nimport { preventDefaultForKeyCodes } from '../preventDefaultForKeyCodes';\nimport { handleAlphaNumerical } from './handleAlphaNumerical';\nimport { handleClick } from './handleClick';\nimport { handleEnterPressed } from './handleEnterPressed';\nimport { handleKeyUpOrDownPressed } from './handleKeyUpOrDownPressed';\n\ninterface TArgs {\n  event: KeyboardEvent;\n  state: IState;\n  props: IProps;\n  RRSClassRef: Select;\n}\n\nexport function handleKeyEvent({ event, state, props, RRSClassRef }: TArgs): void {\n  const { multiselect, isOptionsPanelOpen, disabled } = state;\n\n  if (disabled) return;\n\n  preventDefaultForKeyCodes([keyCodes.ENTER, keyCodes.SPACE, keyCodes.ESCAPE, keyCodes.UP, keyCodes.DOWN], event);\n\n  /* handle alpha-nemeric key press */\n  if (/^[a-z0-9]+$/.test(event.key)) {\n    handleAlphaNumerical({ event, RRSClassRef, state });\n  }\n\n  switch (event.keyCode) {\n    case keyCodes.TAB:\n      /* Don't shift focus when the panel is open (unless it's a Multiselect) */\n      if (isOptionsPanelOpen) {\n        event.preventDefault();\n\n        /**\n         * Multiselect does not close on selection. Focus button to blur and close options panel on TAB\n         * TODO add a test for this\n         */\n        if (multiselect) {\n          RRSClassRef.updateState({ type: actionTypes.SET_OPTIONS_PANEL_CLOSED }, () => RRSClassRef.focusButton());\n        }\n      }\n      break;\n\n    case keyCodes.ENTER:\n      /* can close the panel when open and focussed\n       * can submit the form when closed and focussed */\n      handleEnterPressed({\n        RRSClassRef,\n        event,\n        props,\n        state,\n      });\n      break;\n\n    case keyCodes.SPACE:\n      /* close the panel and select option when open, or open the panel if closed */\n      if (isOptionsPanelOpen) {\n        handleClick({ event, state, RRSClassRef, props });\n      } else {\n        RRSClassRef.updateState({\n          type: actionTypes.SET_OPTIONS_PANEL_OPEN,\n        });\n      }\n      break;\n\n    case keyCodes.ESCAPE:\n      /* remove focus from the panel when focussed */\n      RRSClassRef.updateState({ type: actionTypes.SET_OPTIONS_PANEL_CLOSED_NO_SELECTION }, () =>\n        RRSClassRef.focusButton()\n      );\n      break;\n\n    case keyCodes.UP:\n      /* will open the options panel if closed\n       * will not decrement selection if options panel closed\n       * if panel open, will decrement up the options list */\n      handleKeyUpOrDownPressed({\n        RRSClassRef,\n        state,\n        type: 'DECREMENT',\n      });\n      break;\n\n    case keyCodes.DOWN:\n      /* will open the options panel if closed\n       * will not increment selection if options panel closed\n       * if panel open, will increment down the options list */\n      handleKeyUpOrDownPressed({\n        RRSClassRef,\n        state,\n        type: 'INCREMENT',\n      });\n      break;\n\n    default:\n      break;\n  }\n}\n","import * as actionTypes from '../../constants/actionTypes';\nimport { Select } from '../../react-responsive-select';\nimport { IState } from '../../types/';\n\ninterface TArgs {\n  state: IState;\n  RRSClassRef: Select;\n}\n\nexport function handleTouchMove({ state, RRSClassRef }: TArgs): void {\n  /* if touchmove fired - User is dragging, this disables touchend/click */\n  const { isDragging, disabled } = state;\n\n  if (disabled) return;\n\n  if (!isDragging) {\n    RRSClassRef.updateState({\n      type: actionTypes.SET_IS_DRAGGING,\n      value: true,\n    });\n  }\n}\n","import * as actionTypes from '../../constants/actionTypes';\nimport { Select } from '../../react-responsive-select';\nimport { IState } from '../../types/';\n\ninterface TArgs {\n  state: IState;\n  RRSClassRef: Select;\n}\n\nexport function handleTouchStart({ state, RRSClassRef }: TArgs): void {\n  const { disabled } = state;\n\n  if (disabled) return;\n\n  /* initially it's assumed that the user is not dragging */\n  RRSClassRef.updateState({\n    type: actionTypes.SET_IS_DRAGGING,\n    value: false,\n  });\n}\n","import * as React from 'react';\nimport { IProps, IState } from '../types/';\n\ninterface TArgs {\n  state: IState;\n  props: IProps;\n}\n\nexport function getCustomLabelText({ state, props }: TArgs): React.ReactNode {\n  const { multiselect, customLabelRenderer } = props;\n  const { multiSelectSelectedOptions, singleSelectSelectedOption } = state;\n\n  if (!customLabelRenderer) return false;\n\n  if (multiselect) {\n    return customLabelRenderer(multiSelectSelectedOptions);\n  }\n\n  return customLabelRenderer(singleSelectSelectedOption);\n}\n","export const initialState = {\n  // Constants\n  multiselect: false,\n\n  // Universal\n  name: '',\n  options: [],\n  isDragging: false,\n  isOptionsPanelOpen: false,\n  altered: false,\n\n  // Single select\n  singleSelectInitialIndex: 0,\n  singleSelectSelectedIndex: 0,\n  singleSelectSelectedOption: {},\n\n  // For determining highlighted item on Keyboard navigation\n  nextPotentialSelectionIndex: 0,\n\n  // Multi select\n  multiSelectInitialSelectedIndexes: [0],\n  multiSelectSelectedOptions: {\n    altered: false,\n    options: [],\n  },\n  multiSelectSelectedIndexes: [],\n};\n","import { IState } from '../../types/';\n\nexport function addMultiSelectIndex(state: IState, index: number): number[] {\n  return [...state.multiSelectSelectedIndexes, index];\n}\n","import { IOutputMultiSelect, IState } from '../../types/';\n\nexport function addMultiSelectOption(state: IState, index: number): IOutputMultiSelect {\n  return {\n    options: [\n      ...state.multiSelectSelectedOptions.options,\n      {\n        name: state.name,\n        text: state.options[index].text,\n        value: state.options[index].value,\n      },\n    ],\n  };\n}\n","import { IOption, IState } from '../../types/';\n\ninterface IOutputMultiSelectOptionSansDisabled {\n  value?: string;\n  text?: string;\n  name?: string;\n}\n\ninterface IFindClosestValidOptionOutput {\n  option: IOutputMultiSelectOptionSansDisabled;\n  index: number;\n}\n\nfunction findClosestValidOption(state: IState): { option: IOutputMultiSelectOptionSansDisabled; index: number } {\n  const { options, name } = state;\n  const possibleOptions = options.reduce((acc: IFindClosestValidOptionOutput[], option: IOption, index: number) => {\n    if (!option.optHeader) {\n      acc.push({\n        option: { value: option.value, text: option.text, name },\n        index,\n      });\n    }\n    return acc;\n  }, []);\n\n  // Note: Will fail if there is only one option, and it is an optHeader\n  return possibleOptions[0];\n}\n\nexport function getInitialMultiSelectOption(state: IState): IState {\n  //: { option: IOutputMultiSelectOptionSansDisabled; index: number; }\n  const { option, index } = findClosestValidOption(state);\n\n  return {\n    ...state,\n    multiSelectSelectedIndexes: [index],\n    multiSelectSelectedOptions: { options: [{ ...option }] },\n    nextPotentialSelectionIndex: index,\n  };\n}\n","import { IOption, IOutputMultiSelectOption, IState } from '../../types/';\n\n/* Use existing state.singleSelectSelectedOption, or first possible option to use as a selection */\nfunction findClosestValidOption(state: IState): IOutputMultiSelectOption {\n  const { multiSelectSelectedOptions, options, name } = state;\n\n  if (multiSelectSelectedOptions && multiSelectSelectedOptions.options.length) {\n    return multiSelectSelectedOptions.options[0];\n  }\n\n  const possibleOptions = options.reduce((acc: IOption[], option: IOption) => {\n    if (!option.optHeader) acc.push(option);\n    return acc;\n  }, []);\n\n  // Note: Will fail if no non-optHeader options exist\n  return {\n    name,\n    text: possibleOptions[0].text,\n    value: possibleOptions[0].value,\n  };\n}\n\nexport function getMultiSelectInitialSelectedOptions(\n  state: IState,\n  selectedValues?: string[]\n): IOutputMultiSelectOption[] {\n  const { noSelectionLabel, options, name } = state;\n\n  let selectedOptionsToReturn;\n\n  if (!noSelectionLabel) {\n    // Preselect the first item in the list when if no noSelectionLabel exists\n    if (selectedValues && selectedValues.length > 0) {\n      // Grab selected options by matching option.value with selectedValues, and merge in `name`\n      selectedOptionsToReturn = options\n        .filter((option: IOption) => selectedValues.some((selectedValue: string) => selectedValue === option.value))\n        .map((option: IOption) => ({ name, ...option }));\n    } else {\n      // Grab first option and merge in `name`\n      const option = options[0] && options[0].optHeader ? findClosestValidOption(state) : options[0];\n\n      selectedOptionsToReturn = [\n        {\n          name,\n          text: option.text,\n          value: option.value,\n        },\n      ];\n    }\n\n    return selectedOptionsToReturn;\n  }\n\n  selectedOptionsToReturn =\n    selectedValues && selectedValues.length > 0\n      ? options.reduce((acc: any[], option: IOption) => {\n          if (selectedValues.some((selectedValue: string) => selectedValue === option.value)) {\n            acc.push({ ...option });\n          }\n          return acc;\n        }, [])\n      : [\n          {\n            name: state.name,\n            text: noSelectionLabel,\n            value: 'null',\n          },\n        ];\n\n  return selectedOptionsToReturn;\n}\n","import { nextValidIndex } from '../../lib/nextValidIndex';\nimport { IState } from '../../types/';\n\nexport function getMultiSelectSelectedValueIndexes(\n  state: IState,\n  selectedValues: string[] = [],\n  noSelectionLabel?: string\n): number[] {\n  const { options } = state;\n  const emptyResult = noSelectionLabel ? [] : [nextValidIndex(state, 0)];\n\n  /* return the index of the found item, if found */\n  const result = options.reduce((acc: any, option: any, value: number) => {\n    if (selectedValues.some((selected: string) => option.value === selected)) {\n      acc.push(value);\n    }\n    return acc;\n  }, []);\n\n  /* If something found return that, else return the first item */\n  return result.length > 0 ? result : emptyResult;\n}\n","import { IOption } from '../../types/';\n\ninterface TArgs {\n  options: IOption[];\n  selectedValue: string;\n  noSelectionLabel: string;\n}\n\nexport function getSelectedValueIndex({ options, selectedValue, noSelectionLabel }: TArgs): number {\n  const index = selectedValue ? options.map((option: IOption) => option.value).indexOf(selectedValue) : -1;\n\n  // Allow a negative index if user wants to display a noSelectionLabel\n  // Keyboard will not focus on an option when first opened\n\n  // Select the first option when panel opens if !noSelectionLabel\n  return index > -1 || noSelectionLabel ? index : 0;\n}\n","import { IOption, IState } from '../../types/';\n\n/*\n  use existing state.singleSelectSelectedOption, or first possible option to use as a selection\n*/\nfunction closestValidOption(state: IState): IOption & { name?: string } {\n  if (state.singleSelectSelectedOption) {\n    return state.singleSelectSelectedOption;\n  }\n\n  const possibleOptions: IOption[] = state.options.reduce((acc: IOption[], option: IOption): IOption[] => {\n    if (!option.optHeader) {\n      acc.push(option);\n    }\n    return acc;\n  }, []);\n\n  // Note: Will fail if no non-optHeader options exist\n  return {\n    ...possibleOptions[0],\n    name: state.name,\n  };\n}\n\nexport function getSingleSelectSelectedOption(\n  state: IState,\n  initialSelectedIndex: number = 0\n): IOption & { name?: string } {\n  const selectionIndex = initialSelectedIndex === -1 && !state.noSelectionLabel ? 0 : initialSelectedIndex;\n\n  // if optHeader, then use existing state.singleSelectSelectedOption, or findClosestValidOption\n  if (state.options[selectionIndex] && state.options[selectionIndex].optHeader) {\n    return closestValidOption(state);\n  }\n\n  // Has selection, has no selection use default noSelectionLabel (if exists) and nullify value\n  if (!state.noSelectionLabel) {\n    // Preselect the first item in the list when if no noSelectionLabel exists\n    return {\n      name: state.name,\n      ...state.options[selectionIndex],\n    };\n  }\n\n  return initialSelectedIndex > -1\n    ? {\n        name: state.name,\n        ...state.options[initialSelectedIndex],\n      }\n    : {\n        name: state.name,\n        text: state.noSelectionLabel,\n        value: 'null',\n      };\n}\n","import { IState } from '../../types/';\n\nexport function isAltered(newState: IState): boolean {\n  return !newState.multiselect\n    ? newState.singleSelectSelectedIndex !== newState.singleSelectInitialIndex\n    : !(\n        JSON.stringify(newState.multiSelectInitialSelectedIndexes) ===\n        JSON.stringify(newState.multiSelectSelectedIndexes)\n      );\n}\n\nexport function mergeIsAlteredState(newState: IState): IState {\n  return {\n    ...newState,\n    altered: isAltered(newState),\n  };\n}\n","import { IState } from '../../types/';\n\nexport function removeMultiSelectIndex(state: IState, indexLocation: number): number[] {\n  return [\n    ...state.multiSelectSelectedIndexes.slice(0, indexLocation),\n    ...state.multiSelectSelectedIndexes.slice(indexLocation + 1),\n  ];\n}\n","import { IOutputMultiSelectOption, IState } from '../../types/';\n\nexport function removeMultiSelectOption(\n  state: IState,\n  indexLocation: number\n): {\n  options: IOutputMultiSelectOption[];\n} {\n  return {\n    options: [\n      ...state.multiSelectSelectedOptions.options.slice(0, indexLocation),\n      ...state.multiSelectSelectedOptions.options.slice(indexLocation + 1),\n    ],\n  };\n}\n","import { IState } from '../../types/';\nimport { initialState } from '../initialState';\n\nexport function resetMultiSelectState(state: IState): IState {\n  return {\n    // reset multiSelect state\n    ...state,\n    multiSelectSelectedIndexes: [...initialState.multiSelectSelectedIndexes],\n    multiSelectSelectedOptions: { ...initialState.multiSelectSelectedOptions },\n  };\n}\n","import * as actionTypes from '../constants/actionTypes';\nimport { nextValidIndex } from '../lib/nextValidIndex';\nimport { IAction, IOption, IState } from '../types/';\n\nimport {\n  addMultiSelectIndex,\n  addMultiSelectOption,\n  getInitialMultiSelectOption,\n  getMultiSelectInitialSelectedOptions,\n  getMultiSelectSelectedValueIndexes,\n  getSelectedValueIndex,\n  getSingleSelectSelectedOption,\n  mergeIsAlteredState,\n  removeMultiSelectIndex,\n  removeMultiSelectOption,\n  resetMultiSelectState,\n} from './lib';\n\nexport function reducer(state: IState, action: IAction): IState {\n  switch (action.type) {\n    case actionTypes.INITIALISE: {\n      const initialSelectedIndex = getSelectedValueIndex(action.value);\n      const initialSelectedIndexes = getMultiSelectSelectedValueIndexes(\n        action.value,\n        action.value.selectedValues,\n        action.value.noSelectionLabel\n      );\n\n      return {\n        ...state,\n\n        hasOptHeaders: action.value.options.some((option: IOption) => option.optHeader === true),\n\n        // Constants\n        multiselect: action.value.multiselect || false,\n\n        // Optional nothing selected label\n        noSelectionLabel: action.value.noSelectionLabel,\n\n        // Universal\n        name: action.value.name,\n        options: action.value.options,\n        altered: action.value.altered || false,\n        disabled: action.value.options.length === 0 || action.value.disabled || false,\n\n        // Single select\n        singleSelectInitialIndex: initialSelectedIndex,\n        singleSelectSelectedIndex: initialSelectedIndex,\n        singleSelectSelectedOption: getSingleSelectSelectedOption(action.value, initialSelectedIndex),\n\n        nextPotentialSelectionIndex: state.nextPotentialSelectionIndex\n          ? state.nextPotentialSelectionIndex\n          : initialSelectedIndex,\n\n        // Multi select\n        multiSelectInitialSelectedIndexes: initialSelectedIndexes,\n        multiSelectSelectedIndexes: initialSelectedIndexes,\n        multiSelectSelectedOptions: {\n          options:\n            action.value.options.length > 0\n              ? getMultiSelectInitialSelectedOptions(action.value, action.value.selectedValues)\n              : [],\n        },\n      };\n    }\n\n    case actionTypes.SET_IS_DRAGGING:\n      return {\n        ...state,\n        isDragging: action.value,\n      };\n\n    case actionTypes.SET_OPTIONS_PANEL_OPEN: {\n      const newState = {\n        ...state,\n        isOptionsPanelOpen: true,\n\n        // For determining highlighted item on Keyboard navigation\n        nextPotentialSelectionIndex: ((): number => {\n          if (state.multiselect) {\n            return state.multiSelectSelectedIndexes.length\n              ? nextValidIndex(state, state.multiSelectSelectedIndexes[0])\n              : nextValidIndex(state, 0);\n          }\n          return nextValidIndex(state, state.nextPotentialSelectionIndex);\n        })(),\n\n        singleSelectSelectedOption: getSingleSelectSelectedOption(state, state.nextPotentialSelectionIndex),\n      };\n\n      return mergeIsAlteredState(newState);\n    }\n\n    case actionTypes.SET_OPTIONS_PANEL_CLOSED: {\n      const newState = {\n        ...state,\n        isOptionsPanelOpen: false,\n        singleSelectSelectedIndex: state.nextPotentialSelectionIndex,\n        singleSelectSelectedOption: getSingleSelectSelectedOption(state, state.nextPotentialSelectionIndex),\n      };\n      return mergeIsAlteredState(newState);\n    }\n\n    case actionTypes.SET_OPTIONS_PANEL_CLOSED_NO_SELECTION:\n    case actionTypes.SET_OPTIONS_PANEL_CLOSED_ONBLUR:\n      return {\n        ...state,\n        isOptionsPanelOpen: false,\n      };\n\n    case actionTypes.SET_NEXT_SELECTED_INDEX:\n      return {\n        ...state,\n        nextPotentialSelectionIndex: action.value,\n      };\n\n    case actionTypes.SET_NEXT_SELECTED_INDEX_ALPHA_NUMERIC:\n      return {\n        ...state,\n        isOptionsPanelOpen: true,\n        nextPotentialSelectionIndex: action.value,\n      };\n\n    case actionTypes.SET_SINGLESELECT_OPTIONS: {\n      const nextState = {\n        ...state,\n        nextPotentialSelectionIndex: action.value,\n        singleSelectSelectedIndex: action.value,\n        isOptionsPanelOpen: false,\n        singleSelectSelectedOption: getSingleSelectSelectedOption(state, action.value),\n      };\n\n      // Set altered state\n      return mergeIsAlteredState(nextState);\n    }\n\n    case actionTypes.SET_MULTISELECT_OPTIONS: {\n      if (!state.noSelectionLabel) {\n        const isFirstOptionInListSelected =\n          state.multiSelectSelectedIndexes[0] === 0 && state.multiSelectSelectedIndexes.length === 1;\n\n        // If anything selected and first option was requested, deselect all, then select first option\n        const shouldDeselectAllAndSelectFirstOption =\n          state.multiSelectSelectedIndexes.length > 0 &&\n          !isFirstOptionInListSelected &&\n          action.value === 0 &&\n          !state.noSelectionLabel;\n\n        // Deselect first option when any other value is requested\n        const shouldDeselectFirstOptionAndSelectRequestedOption = isFirstOptionInListSelected && action.value !== 0;\n\n        // If any thing selected and first option was requested, deselect all, and return first option\n        if (shouldDeselectAllAndSelectFirstOption) {\n          return mergeIsAlteredState(getInitialMultiSelectOption(state));\n        }\n\n        // Deselect first option when first option selected and another option is requested\n        if (shouldDeselectFirstOptionAndSelectRequestedOption) {\n          // eslint-disable-next-line no-param-reassign\n          state = resetMultiSelectState(state);\n        }\n      }\n\n      // Remove noSelectionLabel from selected options if something is selected\n      if (state.noSelectionLabel && state.multiSelectSelectedOptions.options[0].text === state.noSelectionLabel) {\n        // eslint-disable-next-line no-param-reassign\n        state.multiSelectSelectedOptions.options = [];\n      }\n\n      // With optHeader, action.value can go out of bounds - check and adjust the value of value when requried\n      const actionOptionIndexAdjusted = nextValidIndex(state, action.value);\n\n      // Find index of requested option\n      const indexLocation = state.multiSelectSelectedIndexes.indexOf(actionOptionIndexAdjusted);\n\n      // If requested item does not exist, add it. Else remove it\n      let nextState = {\n        ...state,\n        nextPotentialSelectionIndex: actionOptionIndexAdjusted,\n        multiSelectSelectedIndexes:\n          indexLocation === -1\n            ? addMultiSelectIndex(state, actionOptionIndexAdjusted)\n            : removeMultiSelectIndex(state, indexLocation),\n        multiSelectSelectedOptions:\n          indexLocation === -1\n            ? addMultiSelectOption(state, actionOptionIndexAdjusted)\n            : removeMultiSelectOption(state, indexLocation),\n      };\n\n      if (nextState.multiSelectSelectedOptions.options.length === 0) {\n        // Reset to noSelectionLabel if user has deselected all items and has set a `noSelectionLabel` prop\n        if (state.noSelectionLabel) {\n          nextState = {\n            ...nextState,\n            nextPotentialSelectionIndex: state.hasOptHeaders ? nextValidIndex(state, -1) : -1,\n            multiSelectSelectedOptions: {\n              options: getMultiSelectInitialSelectedOptions(state),\n            },\n          };\n        } else if (!state.noSelectionLabel) {\n          // Select first option if user has deselected all items\n          nextState = getInitialMultiSelectOption(state);\n        }\n      }\n      // Set altered state\n      return mergeIsAlteredState(nextState);\n    }\n    default:\n      return state;\n  }\n}\n","import * as React from 'react';\nimport singleline from 'singleline';\nimport { IOption } from '../types/';\n\ninterface TProps {\n  name: string;\n  index: number;\n  isOptionsPanelOpen: boolean;\n  nextPotentialSelectionIndex: number;\n  optionsContainerRef: React.RefObject<HTMLUListElement>;\n  optHeaderLabel: string;\n  multiSelectSelectedIndexes: number[];\n  option: IOption;\n}\n\nexport class MultiSelectOption extends React.Component<TProps> {\n  private optionRef: React.RefObject<HTMLLIElement>;\n  private scrollOffset: number;\n\n  constructor(props: TProps) {\n    super(props);\n    this.optionRef = React.createRef();\n    this.scrollOffset = 0;\n  }\n\n  public getScrollOffset(): number {\n    const el = document.querySelector('.rrs__option--header');\n    return Math.ceil((el && el.getBoundingClientRect().height) || 0);\n  }\n\n  public componentDidUpdate(): void {\n    const { index, isOptionsPanelOpen, nextPotentialSelectionIndex, optionsContainerRef, optHeaderLabel } = this.props;\n\n    if (index === nextPotentialSelectionIndex && isOptionsPanelOpen) {\n      if (this.optionRef.current && optionsContainerRef.current) {\n        this.optionRef.current.focus();\n\n        if (optHeaderLabel !== '') {\n          const scrollDiff = Math.ceil(\n            this.optionRef.current.getBoundingClientRect().top - optionsContainerRef.current.getBoundingClientRect().top\n          );\n\n          this.scrollOffset = this.scrollOffset || this.getScrollOffset();\n\n          if (scrollDiff < this.scrollOffset) {\n            optionsContainerRef.current.scroll(\n              0,\n              Math.floor(optionsContainerRef.current.scrollTop - this.scrollOffset)\n            );\n          }\n        }\n      }\n    }\n  }\n\n  public isDisabled(option: IOption): boolean {\n    return Boolean(option.disabled || option.optHeader);\n  }\n\n  public render(): React.ReactNode {\n    const { index, name, multiSelectSelectedIndexes, nextPotentialSelectionIndex, option, optHeaderLabel } = this.props;\n    const isSelected = multiSelectSelectedIndexes.some((i: number) => i === index);\n\n    return (\n      <li\n        role=\"checkbox\"\n        data-testid={`rrs-option_${name}_${index}`}\n        tabIndex={-1}\n        aria-checked={isSelected}\n        aria-label={`\n        ${option.text || (option.markup && (option.markup as HTMLElement).textContent)} ${\n          optHeaderLabel !== '' ? ` of ${optHeaderLabel}` : ''\n        }\n      `}\n        aria-live=\"assertive\"\n        aria-disabled={this.isDisabled(option) ? 'true' : 'false'}\n        data-key={index}\n        ref={this.optionRef}\n        className={singleline(`\n          rrs__option\n          ${isSelected ? 'rrs__option--selected' : ''}\n          ${nextPotentialSelectionIndex === index ? 'rrs__option--next-selection' : ''}\n          ${option.disabled === true ? 'rrs__option--disabled' : ''}\n          ${option.optHeader === true ? 'rrs__option--header' : ''}\n        `)}\n      >\n        {option.markup || option.text}\n      </li>\n    );\n  }\n}\n","import * as React from 'react';\nimport singleline from 'singleline';\nimport { IOption, IOutputMultiSelect, IOutputMultiSelectOption } from '../types/';\nimport { MultiSelectOption } from './MultiSelectOption';\n\ninterface TProps {\n  selectBoxRef: HTMLDivElement | null;\n  caretIcon: React.ReactNode;\n  customLabelText: React.ReactNode;\n  disabled: boolean;\n  isDragging: boolean;\n  isOptionsPanelOpen: boolean;\n  multiSelectSelectedIndexes: number[];\n  multiSelectSelectedOptions: IOutputMultiSelect;\n  name: string;\n  options: IOption[];\n  nextPotentialSelectionIndex: number;\n  prefix: string;\n}\n\nexport class MultiSelect extends React.Component<TProps> {\n  private optionsButton: React.RefObject<HTMLDivElement>;\n  private optionsContainer: React.RefObject<HTMLUListElement>;\n\n  constructor(props: TProps) {\n    super(props);\n    this.optionsButton = React.createRef();\n    this.optionsContainer = React.createRef();\n  }\n\n  public componentDidUpdate(prevProps: TProps): void {\n    /*\n      Focus selectBox button if options panel has just closed,\n      there has been an interaction or the value has changed\n    */\n    const { isOptionsPanelOpen, selectBoxRef } = this.props;\n\n    const optionsPanelJustClosed = !isOptionsPanelOpen && prevProps.isOptionsPanelOpen;\n\n    if (optionsPanelJustClosed && selectBoxRef && selectBoxRef.contains(document.activeElement)) {\n      // tslint:disable-next-line\n      this.optionsButton.current && this.optionsButton.current.focus();\n    }\n  }\n\n  public getAriaLabel(): string {\n    const { multiSelectSelectedOptions, prefix } = this.props;\n    const selectedOptionsLength = multiSelectSelectedOptions.options.length;\n\n    return singleline(`\n      Checkbox group ${prefix ? `${prefix} ` : ''} has\n      ${selectedOptionsLength} item${selectedOptionsLength === 1 ? '' : 's'} selected.\n      Selected option${selectedOptionsLength === 1 ? '' : 's'} ${selectedOptionsLength === 1 ? 'is' : 'are'}\n      ${multiSelectSelectedOptions.options\n        .map((option: IOutputMultiSelectOption): string => option.text || '')\n        .join(' and ')}\n    `);\n  }\n\n  public render(): React.ReactNode {\n    const {\n      caretIcon,\n      customLabelText,\n      disabled,\n      isOptionsPanelOpen,\n      multiSelectSelectedIndexes,\n      multiSelectSelectedOptions,\n      name,\n      options,\n      nextPotentialSelectionIndex,\n      prefix,\n    } = this.props;\n\n    let optHeaderLabel: string = '';\n\n    return (\n      <div>\n        <div\n          role=\"button\"\n          tabIndex={0}\n          aria-disabled={disabled}\n          aria-haspopup=\"true\"\n          aria-expanded={isOptionsPanelOpen}\n          aria-controls={`rrs-${name}-menu`}\n          ref={this.optionsButton}\n          className={singleline(`\n            rrs__button\n            ${disabled === true ? 'rrs__button--disabled' : ''}\n          `)}\n        >\n          {customLabelText && (\n            <div className=\"rrs__label\">\n              <span\n                aria-label={this.getAriaLabel()}\n                className=\"rrs__label__text\"\n                id={`rrs-${name}-label`}\n                data-testid={`rrs-label_${name}`}\n              >\n                {customLabelText}\n              </span>\n              {caretIcon && caretIcon}\n            </div>\n          )}\n\n          {!customLabelText && (\n            <div className=\"rrs__label\">\n              <span\n                aria-label={this.getAriaLabel()}\n                className=\"rrs__label__text\"\n                id={`rrs-${name}-label`}\n                data-testid={`rrs-label_${name}`}\n              >\n                <span className=\"rrs__multiselect-label\">\n                  <span className=\"rrs__multiselect-label__text\">\n                    {`${prefix ? `${prefix} ` : ''}\n                  ${multiSelectSelectedOptions.options.length > 0 ? multiSelectSelectedOptions.options[0].text : ''}`}\n                  </span>\n                  {multiSelectSelectedOptions.options.length > 1 && (\n                    <span className=\"rrs__multiselect-label__badge\">\n                      {`+ ${multiSelectSelectedOptions.options.length - 1}`}\n                    </span>\n                  )}\n                </span>\n              </span>\n              {caretIcon && caretIcon}\n            </div>\n          )}\n\n          {name && (\n            <input\n              type=\"hidden\"\n              name={name}\n              data-testid={`rrs-input_${name}`}\n              value={[multiSelectSelectedOptions.options.map((v: IOutputMultiSelectOption) => v.value)].join(',')}\n            />\n          )}\n        </div>\n\n        <ul\n          id={`rrs-${name}-menu`}\n          aria-labelledby={`rrs-${name}-label`}\n          role=\"menu\"\n          className=\"rrs__options\"\n          ref={this.optionsContainer}\n        >\n          {options.length > 0 &&\n            options.map((option: IOption, index: number) => {\n              if (option.optHeader) {\n                optHeaderLabel = option.text || (option.markup && (option.markup as HTMLElement).textContent) || '';\n              }\n              return (\n                <MultiSelectOption\n                  key={index}\n                  name={name}\n                  optHeaderLabel={optHeaderLabel}\n                  optionsContainerRef={this.optionsContainer}\n                  index={index}\n                  option={option}\n                  isOptionsPanelOpen={isOptionsPanelOpen}\n                  multiSelectSelectedIndexes={multiSelectSelectedIndexes}\n                  nextPotentialSelectionIndex={nextPotentialSelectionIndex}\n                />\n              );\n            })}\n        </ul>\n      </div>\n    );\n  }\n}\n","import * as React from 'react';\nimport singleline from 'singleline';\nimport { IOption } from '../types/';\n\ninterface TProps {\n  index: number;\n  name: string;\n  isOptionsPanelOpen: boolean;\n  optionsContainerRef: React.RefObject<HTMLUListElement>;\n  nextPotentialSelectionIndex: number;\n  option: IOption;\n  singleSelectSelectedIndex: number;\n  optHeaderLabel: string;\n}\n\nexport class SingleSelectOption extends React.Component<TProps> {\n  private optionRef: React.RefObject<HTMLLIElement>;\n  private scrollOffset: number;\n\n  constructor(props: TProps) {\n    super(props);\n    this.optionRef = React.createRef();\n    this.scrollOffset = 0;\n  }\n\n  public getScrollOffset(): number {\n    const el = document.querySelector('.rrs__option--header');\n    return Math.ceil((el && el.getBoundingClientRect().height) || 0);\n  }\n\n  public componentDidUpdate(): void {\n    const { index, isOptionsPanelOpen, nextPotentialSelectionIndex, optionsContainerRef, optHeaderLabel } = this.props;\n\n    if (index === nextPotentialSelectionIndex && isOptionsPanelOpen) {\n      if (this.optionRef.current && optionsContainerRef.current) {\n        this.optionRef.current.focus();\n\n        if (optHeaderLabel !== '') {\n          const scrollDiff = Math.ceil(\n            this.optionRef.current.getBoundingClientRect().top - optionsContainerRef.current.getBoundingClientRect().top\n          );\n\n          this.scrollOffset = this.scrollOffset || this.getScrollOffset();\n\n          if (scrollDiff < this.scrollOffset) {\n            optionsContainerRef.current.scroll(\n              0,\n              Math.floor(optionsContainerRef.current.scrollTop - this.scrollOffset)\n            );\n          }\n        }\n      }\n    }\n  }\n\n  public isDisabled(option: IOption): boolean {\n    return Boolean(option.disabled || option.optHeader);\n  }\n\n  public render(): React.ReactNode {\n    const { index, name, nextPotentialSelectionIndex, option, singleSelectSelectedIndex, optHeaderLabel } = this.props;\n\n    return (\n      <li\n        role=\"menuitem\"\n        data-testid={`rrs-option_${name}_${index}`}\n        tabIndex={-1}\n        aria-disabled={this.isDisabled(option) ? 'true' : 'false'}\n        aria-label={`\n          ${option.text || (option.markup && (option.markup as HTMLElement).textContent)} ${\n          optHeaderLabel !== '' ? ` of ${optHeaderLabel}` : ''\n        }\n        `}\n        data-key={index}\n        ref={this.optionRef}\n        className={singleline(`\n          rrs__option\n          ${singleSelectSelectedIndex === index ? 'rrs__option--selected' : ''}\n          ${nextPotentialSelectionIndex === index ? 'rrs__option--next-selection' : ''}\n          ${option.disabled === true ? 'rrs__option--disabled' : ''}\n          ${option.optHeader === true ? 'rrs__option--header' : ''}\n        `)}\n      >\n        {option.markup || option.text}\n      </li>\n    );\n  }\n}\n","import * as React from 'react';\nimport singleline from 'singleline';\nimport { IOption, IOutputSingleSelect } from '../types/';\nimport { SingleSelectOption } from './SingleSelectOption';\n\ninterface TProps {\n  prefix: string;\n  singleSelectSelectedOption: IOutputSingleSelect;\n  name: string;\n  caretIcon: React.ReactNode;\n  singleSelectSelectedIndex: number;\n  noSelectionLabel: string;\n  isOptionsPanelOpen: boolean;\n  nextPotentialSelectionIndex: number;\n  selectBoxRef: HTMLDivElement | null;\n  customLabelText: React.ReactNode;\n  disabled: boolean;\n  options: IOption[];\n}\n\nexport class SingleSelect extends React.Component<TProps> {\n  private optionsButton: React.RefObject<HTMLDivElement>;\n  private optionsContainer: React.RefObject<HTMLUListElement>;\n\n  constructor(props: TProps) {\n    super(props);\n    this.optionsButton = React.createRef();\n    this.optionsContainer = React.createRef();\n  }\n\n  public componentDidUpdate(prevProps: TProps): void {\n    /*\n      Focus selectBox button if options panel has just closed,\n      there has been an interaction,\n      or isOptionsPanelOpen and nextPotentialSelectionIndex === -1\n    */\n    const { isOptionsPanelOpen, nextPotentialSelectionIndex, selectBoxRef } = this.props;\n\n    const optionsPanelJustClosed = !isOptionsPanelOpen && prevProps.isOptionsPanelOpen;\n\n    if (this.optionsButton.current) {\n      if (optionsPanelJustClosed && selectBoxRef && selectBoxRef.contains(document.activeElement)) {\n        this.optionsButton.current.focus();\n      }\n\n      if (isOptionsPanelOpen && nextPotentialSelectionIndex === -1) {\n        this.optionsButton.current.focus();\n      }\n    }\n  }\n\n  public getCustomLabel(): React.ReactNode {\n    const { prefix, name, singleSelectSelectedOption, caretIcon, customLabelText } = this.props;\n\n    return (\n      <div className=\"rrs__label\">\n        <span\n          aria-label={`${prefix ? `${prefix} ` : ''}${singleSelectSelectedOption.text} selected`}\n          className=\"rrs__label__text\"\n          id={`rrs-${name}-label`}\n          data-testid={`rrs-label_${name}`}\n        >\n          {customLabelText}\n        </span>\n        {caretIcon && caretIcon}\n      </div>\n    );\n  }\n\n  public getDefaultLabel(): React.ReactNode {\n    const {\n      prefix,\n      singleSelectSelectedOption,\n      name,\n      caretIcon,\n      singleSelectSelectedIndex,\n      noSelectionLabel,\n    } = this.props;\n\n    if (singleSelectSelectedIndex === -1) {\n      return (\n        <div className=\"rrs__label\">\n          <span\n            aria-label={noSelectionLabel}\n            className=\"rrs__label__text\"\n            id={`rrs-${name}-label`}\n            data-testid={`rrs-label_${name}`}\n          >\n            {prefix && <span>{prefix}</span>}\n            {noSelectionLabel}\n          </span>\n          {caretIcon && caretIcon}\n        </div>\n      );\n    }\n\n    return (\n      <div className=\"rrs__label\">\n        <span\n          aria-label={`${prefix ? `${prefix} ` : ''}${singleSelectSelectedOption.text} selected`}\n          className=\"rrs__label__text\"\n          id={`rrs-${name}-label`}\n          data-testid={`rrs-label_${name}`}\n        >\n          {prefix && <span>{prefix}</span>}\n          {singleSelectSelectedOption.text ? singleSelectSelectedOption.text : <span>&nbsp;</span>}\n        </span>\n        {caretIcon && caretIcon}\n      </div>\n    );\n  }\n\n  public render(): React.ReactNode {\n    const {\n      customLabelText,\n      disabled,\n      isOptionsPanelOpen,\n      name,\n      nextPotentialSelectionIndex,\n      options,\n      singleSelectSelectedIndex,\n      singleSelectSelectedOption,\n    } = this.props;\n\n    let optHeaderLabel: string = '';\n\n    return (\n      <div>\n        <div\n          role=\"button\"\n          tabIndex={0}\n          aria-disabled={disabled}\n          aria-haspopup=\"true\"\n          aria-expanded={isOptionsPanelOpen}\n          aria-controls={`rrs-${name}-menu`}\n          ref={this.optionsButton}\n          className={singleline(`\n            rrs__button\n            ${disabled === true ? 'rrs__button--disabled' : ''}\n          `)}\n        >\n          {customLabelText ? this.getCustomLabel() : this.getDefaultLabel()}\n\n          {name && (\n            <input\n              type=\"hidden\"\n              name={name}\n              data-testid={`rrs-input_${name}`}\n              value={singleSelectSelectedOption.value}\n            />\n          )}\n        </div>\n\n        <ul\n          id={`rrs-${name}-menu`}\n          aria-labelledby={`rrs-${name}-label`}\n          role=\"menu\"\n          className=\"rrs__options\"\n          ref={this.optionsContainer}\n        >\n          {options.length > 0 &&\n            options.map((option: IOption, index: number) => {\n              if (option.optHeader) {\n                optHeaderLabel = option.text || (option.markup && (option.markup as HTMLElement).textContent) || '';\n              }\n              return (\n                <SingleSelectOption\n                  key={index}\n                  name={name}\n                  optHeaderLabel={optHeaderLabel}\n                  optionsContainerRef={this.optionsContainer}\n                  index={index}\n                  isOptionsPanelOpen={isOptionsPanelOpen}\n                  option={option}\n                  singleSelectSelectedIndex={singleSelectSelectedIndex}\n                  nextPotentialSelectionIndex={nextPotentialSelectionIndex}\n                />\n              );\n            })}\n        </ul>\n      </div>\n    );\n  }\n}\n","import React from 'react';\n\n/* tslint:disable:max-line-length*/\nexport const CaretIcon = (props: any): React.ReactElement => (\n  <svg\n    className=\"caret-icon\"\n    x=\"0px\"\n    y=\"0px\"\n    width=\"11.848px\"\n    height=\"6.338px\"\n    viewBox=\"351.584 2118.292 11.848 6.338\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    {...props}\n  >\n    <g>\n      <path d=\"M363.311,2118.414c-0.164-0.163-0.429-0.163-0.592,0l-5.205,5.216l-5.215-5.216c-0.163-0.163-0.429-0.163-0.592,0s-0.163,0.429,0,0.592l5.501,5.501c0.082,0.082,0.184,0.123,0.296,0.123c0.103,0,0.215-0.041,0.296-0.123l5.501-5.501C363.474,2118.843,363.474,2118.577,363.311,2118.414L363.311,2118.414z\" />\n    </g>\n  </svg>\n);\n\nexport const ErrorIcon = (props: any): React.ReactElement => (\n  <svg\n    x=\"0px\"\n    y=\"0px\"\n    width=\"12px\"\n    height=\"12px\"\n    viewBox=\"0 0 1000 1000\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    style={{ fill: 'currentColor', marginRight: '4px' }}\n    {...props}\n  >\n    <g>\n      <path d=\"M868,953.8H132.1c-49.3,0-89-19.3-108.8-53.1C3.5,867,5.9,822.9,29.9,779.8l371.3-665.4c24.2-43.4,60.1-68.2,98.6-68.2c38.5,0,74.4,24.8,98.6,68.2L970,779.9c24,43.1,26.5,87.1,6.7,120.8C956.9,934.5,917.3,953.8,868,953.8L868,953.8z M499.8,116.1c-12.2,0-26.2,12.1-37.6,32.4L90.9,813.9c-11.6,20.9-14.4,39.6-7.4,51.5c7,11.8,24.7,18.6,48.5,18.6H868c23.9,0,41.6-6.7,48.5-18.6c6.9-11.8,4.2-30.6-7.4-51.4L537.4,148.5C526.1,128.2,512,116.1,499.8,116.1L499.8,116.1z M500,638.7c-19.3,0-34.9-15.6-34.9-34.9V289.5c0-19.3,15.6-34.9,34.9-34.9c19.3,0,34.9,15.6,34.9,34.9v314.3C534.9,623.1,519.3,638.7,500,638.7z M447.6,761.1c0,28.9,23.5,52.4,52.4,52.4c28.9,0,52.4-23.5,52.4-52.4c0-28.9-23.5-52.4-52.4-52.4C471.1,708.7,447.6,732.2,447.6,761.1z\" />\n    </g>\n  </svg>\n);\n\nexport const ModalCloseButton = (props: any): React.ReactElement => (\n  <div>\n    <svg\n      className=\"mobile-close__icon\"\n      xmlns=\"http://www.w3.org/2000/svg\"\n      width=\"12px\"\n      height=\"12px\"\n      viewBox=\"0 0 2541 2541\"\n      {...props}\n    >\n      <path d=\"M29 172c-39-39-39-103 0-142s103-39 142 0l1099 1099L2369 30c39-39 103-39 142 0s39 103 0 142L1412 1271l1099 1099c39 39 39 103 0 142s-103 39-142 0L1270 1413 171 2512c-39 39-103 39-142 0s-39-103 0-142l1099-1099L29 172z\" />\n    </svg>\n  </div>\n);\n\nexport const CheckboxIcon = (props: any): React.ReactElement => (\n  <svg\n    className=\"checkbox-icon\"\n    xmlns=\"http://www.w3.org/2000/svg\"\n    x=\"0px\"\n    y=\"0px\"\n    width=\"12px\"\n    height=\"12px\"\n    viewBox=\"0 0 488.878 488.878\"\n    {...props}\n  >\n    <g>\n      <polygon points=\"143.294,340.058 50.837,247.602 0,298.439 122.009,420.447 122.149,420.306 144.423,442.58 488.878,98.123 437.055,46.298 \" />\n    </g>\n  </svg>\n);\n\nexport const MultiSelectOptionMarkup = ({ text, ...props }: { text: string; props: any }): React.ReactElement => (\n  <div className=\"checkbox-container\">\n    <span className=\"checkbox\">\n      <CheckboxIcon {...props} />\n    </span>\n    <span className=\"checkbox-text\"> {text}</span>\n  </div>\n);\n/* tslint:enable:max-line-length */\n","import * as React from 'react';\nimport singleline from 'singleline';\nimport * as actionTypes from './constants/actionTypes';\nimport { handleBlur, handleClick, handleKeyEvent, handleTouchMove, handleTouchStart } from './lib/eventHandlers';\nimport { getCustomLabelText } from './lib/getCustomLabelText';\nimport { multiSelectBroadcastChange, singleSelectBroadcastChange } from './lib/onChangeBroadcasters';\nimport { initialState } from './reducers/initialState';\nimport { reducer } from './reducers/reducer';\nimport { IAction, IProps, IState } from './types/';\n\nimport { MultiSelect } from './components/MultiSelect';\nimport { SingleSelect } from './components/SingleSelect';\n\nexport class Select extends React.Component<IProps, IState> {\n  public selectBox: HTMLDivElement | null;\n  private reducer: (state: IState, action: IAction) => IState;\n  private firstLoad: boolean;\n\n  constructor(props: IProps) {\n    super(props);\n    this.state = initialState;\n    this.reducer = reducer;\n    this.firstLoad = true;\n    this.selectBox = null;\n  }\n\n  public componentDidMount(): void {\n    const { options, noSelectionLabel, selectedValue, selectedValues, name, multiselect, disabled } = this.props;\n\n    this.updateState({\n      type: actionTypes.INITIALISE,\n      value: {\n        options,\n        noSelectionLabel,\n        selectedValue,\n        selectedValues,\n        name,\n        multiselect,\n        disabled,\n      },\n    });\n  }\n\n  public componentDidUpdate(_prevProps: IProps, prevState: IState): boolean {\n    const { singleSelectSelectedOption, multiSelectSelectedOptions, multiselect, altered } = this.state;\n    const { onChange } = this.props;\n\n    if (this.firstLoad) {\n      this.firstLoad = false;\n      return false;\n    }\n\n    if (multiselect) {\n      multiSelectBroadcastChange(\n        multiSelectSelectedOptions.options,\n        Boolean(altered),\n        onChange,\n        prevState.multiSelectSelectedOptions.options\n      );\n    } else {\n      singleSelectBroadcastChange(\n        singleSelectSelectedOption,\n        Boolean(altered),\n        onChange,\n        prevState.singleSelectSelectedOption\n      );\n    }\n\n    return true;\n  }\n\n  public updateState(action: IAction, callback?: (nextState: IState) => any): void {\n    const { onListen, name } = this.props;\n    const nextState = this.reducer(this.state, action);\n\n    this.setState(nextState, () => {\n      if (callback) {\n        callback(nextState);\n      }\n    });\n\n    /* Allow user to listen to actions being fired */\n    if (onListen) {\n      const isOpen = [\n        actionTypes.SET_OPTIONS_PANEL_OPEN,\n        actionTypes.SET_NEXT_SELECTED_INDEX,\n        actionTypes.SET_NEXT_SELECTED_INDEX_ALPHA_NUMERIC,\n        actionTypes.SET_IS_DRAGGING,\n      ].some((actionType: string) => action.type === actionType);\n\n      onListen(isOpen, name, action.type);\n    }\n  }\n\n  public focusButton(): void {\n    const el: HTMLDivElement | null = this.selectBox && this.selectBox.querySelector('.rrs__button');\n    // tslint:disable-next-line no-unused-expression\n    el && el.focus();\n  }\n\n  public onHandleKeyEvent = (e: any): void => {\n    handleKeyEvent({\n      event: e,\n      RRSClassRef: this,\n      state: this.state,\n      props: this.props,\n    });\n  };\n\n  public onHandleTouchStart = (_e: any): void => {\n    handleTouchStart({\n      RRSClassRef: this,\n      state: this.state,\n    });\n  };\n\n  public onHandleTouchMove = (_e: any): void => {\n    handleTouchMove({\n      RRSClassRef: this,\n      state: this.state,\n    });\n  };\n\n  public onHandleClick = (e: any): void => {\n    handleClick({\n      event: e,\n      RRSClassRef: this,\n      state: this.state,\n      props: this.props,\n    });\n  };\n\n  public onHandleBlur = (_e: any): void => {\n    handleBlur({\n      RRSClassRef: this,\n      state: this.state,\n      props: this.props,\n    });\n  };\n\n  public render(): React.ReactNode {\n    const { prefix, caretIcon, modalCloseButton } = this.props;\n    const {\n      altered,\n      disabled,\n      hasOptHeaders,\n      isOptionsPanelOpen,\n      isDragging,\n      noSelectionLabel,\n      multiSelectSelectedIndexes,\n      multiSelectSelectedOptions,\n      name,\n      nextPotentialSelectionIndex,\n      options,\n      singleSelectSelectedIndex,\n      singleSelectSelectedOption,\n      multiselect,\n    } = this.state;\n\n    const customLabelText = getCustomLabelText({\n      props: this.props,\n      state: this.state,\n    });\n\n    return (\n      <div\n        data-testid={name}\n        data-name={name}\n        className={singleline(`\n          rrs\n          ${isOptionsPanelOpen === true ? 'rrs--options-visible' : ''}\n          ${altered ? 'rrs--has-changed' : ''}\n          ${hasOptHeaders ? 'rrs--has-opt-headers' : ''}\n        `)}\n        ref={(r: HTMLDivElement): void => {\n          this.selectBox = r;\n        }}\n        tabIndex={-1}\n        onKeyDown={this.onHandleKeyEvent}\n        onTouchStart={this.onHandleTouchStart}\n        onTouchMove={this.onHandleTouchMove}\n        onTouchEnd={this.onHandleClick}\n        onMouseDown={this.onHandleClick}\n        onBlur={this.onHandleBlur}\n      >\n        {!!modalCloseButton && isOptionsPanelOpen === true && (\n          <div aria-hidden=\"true\" className=\"mobile-close\">\n            {modalCloseButton}\n          </div>\n        )}\n        {multiselect ? (\n          <MultiSelect\n            disabled={Boolean(disabled)}\n            isDragging={isDragging}\n            caretIcon={caretIcon}\n            customLabelText={customLabelText}\n            prefix={prefix || ''}\n            name={name}\n            multiSelectSelectedOptions={multiSelectSelectedOptions}\n            multiSelectSelectedIndexes={multiSelectSelectedIndexes}\n            nextPotentialSelectionIndex={nextPotentialSelectionIndex}\n            isOptionsPanelOpen={isOptionsPanelOpen}\n            options={options}\n            selectBoxRef={this.selectBox}\n          />\n        ) : (\n          <SingleSelect\n            noSelectionLabel={noSelectionLabel || ''}\n            disabled={Boolean(disabled)}\n            caretIcon={caretIcon}\n            prefix={prefix || ''}\n            name={name}\n            customLabelText={customLabelText}\n            singleSelectSelectedOption={singleSelectSelectedOption}\n            singleSelectSelectedIndex={singleSelectSelectedIndex}\n            nextPotentialSelectionIndex={nextPotentialSelectionIndex}\n            isOptionsPanelOpen={isOptionsPanelOpen}\n            options={options}\n            selectBoxRef={this.selectBox}\n          />\n        )}\n      </div>\n    );\n  }\n}\n\nexport * from './Extras';\nexport * from './types/';\n"],"names":["INITIALISE","SET_IS_DRAGGING","SET_OPTIONS_PANEL_OPEN","SET_OPTIONS_PANEL_CLOSED","SET_SINGLESELECT_OPTIONS","SET_MULTISELECT_OPTIONS","SET_OPTIONS_PANEL_CLOSED_NO_SELECTION","SET_OPTIONS_PANEL_CLOSED_ONBLUR","SET_NEXT_SELECTED_INDEX","SET_NEXT_SELECTED_INDEX_ALPHA_NUMERIC","stringMatch","timeoutActive","handleAlphaNumerical","event","state","RRSClassRef","options","disabled","key","setTimeout","foundIndexes","reduce","acc","option","index","optHeader","text","toLowerCase","indexOf","push","length","updateState","value","type","actionTypes","skipCircularReference","cache","_key","isEqual","a","b","JSON","stringify","multiSelectBroadcastChange","currOptions","altered","fn","prevOptions","shouldBroadcastChange","values","map","currOption","name","singleSelectBroadcastChange","currValue","prevValue","handleBlur","props","onBlur","multiselect","isOptionsPanelOpen","singleSelectSelectedOption","multiSelectSelectedOptions","isOutsideSelectBox","selectBox","contains","document","activeElement","Boolean","containsClassName","element","classNameStr","String","className","split","handleClick","isDragging","preventDefault","target","parseFloat","getAttribute","isExistingSelection","some","hasOwnProperty","onSelect","onDeselect","focusButton","newState","handleEnterPressed","nextPotentialSelectionIndex","stopPropagation","onSubmit","keyCodes","TAB","ENTER","SPACE","ESCAPE","UP","DOWN","preventDefaultForKeyCodes","e","forEach","keyCode","nextValidIndex","mode","possibleOptionIndexes","indexNotFocusable","nextSelectionPossible","getNextIndex","handleKeyUpOrDownPressed","handleKeyEvent","test","handleTouchMove","handleTouchStart","getCustomLabelText","customLabelRenderer","initialState","singleSelectInitialIndex","singleSelectSelectedIndex","multiSelectInitialSelectedIndexes","multiSelectSelectedIndexes","addMultiSelectIndex","addMultiSelectOption","findClosestValidOption","possibleOptions","getInitialMultiSelectOption","getMultiSelectInitialSelectedOptions","selectedValues","noSelectionLabel","selectedOptionsToReturn","filter","selectedValue","getMultiSelectSelectedValueIndexes","emptyResult","result","selected","getSelectedValueIndex","closestValidOption","getSingleSelectSelectedOption","initialSelectedIndex","selectionIndex","isAltered","mergeIsAlteredState","removeMultiSelectIndex","indexLocation","slice","removeMultiSelectOption","resetMultiSelectState","reducer","action","initialSelectedIndexes","hasOptHeaders","nextState","isFirstOptionInListSelected","shouldDeselectAllAndSelectFirstOption","shouldDeselectFirstOptionAndSelectRequestedOption","actionOptionIndexAdjusted","MultiSelectOption","optionRef","React","scrollOffset","getScrollOffset","el","querySelector","Math","ceil","getBoundingClientRect","height","componentDidUpdate","optionsContainerRef","optHeaderLabel","current","focus","scrollDiff","top","scroll","floor","scrollTop","isDisabled","render","isSelected","i","role","tabIndex","markup","textContent","ref","singleline","MultiSelect","optionsButton","optionsContainer","prevProps","selectBoxRef","optionsPanelJustClosed","getAriaLabel","prefix","selectedOptionsLength","join","caretIcon","customLabelText","id","v","SingleSelectOption","SingleSelect","getCustomLabel","getDefaultLabel","CaretIcon","x","y","width","viewBox","xmlns","d","ErrorIcon","style","fill","marginRight","ModalCloseButton","CheckboxIcon","points","MultiSelectOptionMarkup","Select","_e","firstLoad","componentDidMount","_prevProps","prevState","onChange","callback","onListen","setState","isOpen","actionType","modalCloseButton","r","onKeyDown","onHandleKeyEvent","onTouchStart","onHandleTouchStart","onTouchMove","onHandleTouchMove","onTouchEnd","onHandleClick","onMouseDown","onHandleBlur"],"mappings":"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"}